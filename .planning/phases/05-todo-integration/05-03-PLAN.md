---
phase: 05-todo-integration
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/Canvas/framePresets.ts
  - frontend/src/components/Canvas/CustomToolbar.tsx
autonomous: true

must_haves:
  truths:
    - "User can create Kanban frame preset (3 columns: To Do, In Progress, Done)"
    - "User can create Eisenhower matrix preset (2x2 grid)"
    - "User can create custom empty frame section"
    - "Frame presets accessible via toolbar menu"
  artifacts:
    - path: "frontend/src/components/Canvas/framePresets.ts"
      provides: "Frame creation functions"
      exports: ["createKanbanBoard", "createEisenhowerMatrix", "createCustomFrame"]
    - path: "frontend/src/components/Canvas/CustomToolbar.tsx"
      provides: "Frame preset buttons/menu"
      contains: "createKanbanBoard"
  key_links:
    - from: "frontend/src/components/Canvas/CustomToolbar.tsx"
      to: "framePresets.ts"
      via: "import and call"
      pattern: "createKanbanBoard|createEisenhowerMatrix"
    - from: "frontend/src/components/Canvas/framePresets.ts"
      to: "editor.createShape"
      via: "shape creation"
      pattern: "createShape.*frame"
---

<objective>
Create frame preset system for visual task grouping on canvas.

Purpose: Enable users to quickly create organized layouts for TODO cards using Kanban boards, Eisenhower matrices, or custom sections. Frames provide visual grouping and auto-parenting when cards are dropped inside.

Output: Frame preset creation functions, toolbar integration for preset selection.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-todo-integration/05-CONTEXT.md
@.planning/phases/05-todo-integration/05-RESEARCH.md
@frontend/src/components/Canvas/CustomToolbar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create frame preset functions</name>
  <files>
    frontend/src/components/Canvas/framePresets.ts
  </files>
  <action>
Create `frontend/src/components/Canvas/framePresets.ts`:

1. Import Editor from 'tldraw'

2. Create Kanban board preset:
   ```typescript
   export function createKanbanBoard(editor: Editor, x: number, y: number): void {
     const columns = [
       { name: 'To Do', color: 'blue' },
       { name: 'In Progress', color: 'yellow' },
       { name: 'Done', color: 'green' }
     ]
     const columnWidth = 300
     const columnHeight = 500
     const gap = 20

     columns.forEach((col, index) => {
       editor.createShape({
         type: 'frame',
         x: x + (columnWidth + gap) * index,
         y: y,
         props: {
           w: columnWidth,
           h: columnHeight,
           name: col.name,
         }
       })
     })
   }
   ```

3. Create Eisenhower matrix preset:
   ```typescript
   export function createEisenhowerMatrix(editor: Editor, x: number, y: number): void {
     const quadrants = [
       { name: 'Urgent & Important', row: 0, col: 0 },
       { name: 'Not Urgent & Important', row: 0, col: 1 },
       { name: 'Urgent & Not Important', row: 1, col: 0 },
       { name: 'Not Urgent & Not Important', row: 1, col: 1 }
     ]
     const cellWidth = 350
     const cellHeight = 300
     const gap = 10

     quadrants.forEach(q => {
       editor.createShape({
         type: 'frame',
         x: x + q.col * (cellWidth + gap),
         y: y + q.row * (cellHeight + gap),
         props: {
           w: cellWidth,
           h: cellHeight,
           name: q.name,
         }
       })
     })
   }
   ```

4. Create weekly columns preset:
   ```typescript
   export function createWeeklyColumns(editor: Editor, x: number, y: number): void {
     const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday']
     const columnWidth = 200
     const columnHeight = 400
     const gap = 15

     days.forEach((day, index) => {
       editor.createShape({
         type: 'frame',
         x: x + (columnWidth + gap) * index,
         y: y,
         props: {
           w: columnWidth,
           h: columnHeight,
           name: day,
         }
       })
     })
   }
   ```

5. Create custom empty frame:
   ```typescript
   export function createCustomFrame(editor: Editor, x: number, y: number, name: string = 'Section'): void {
     editor.createShape({
       type: 'frame',
       x: x,
       y: y,
       props: {
         w: 300,
         h: 400,
         name: name,
       }
     })
   }
   ```

6. Helper to get center of viewport for placement:
   ```typescript
   export function getViewportCenter(editor: Editor): { x: number; y: number } {
     const bounds = editor.getViewportScreenBounds()
     const center = editor.screenToPage({ x: bounds.w / 2, y: bounds.h / 2 })
     return { x: center.x - 300, y: center.y - 200 }  // Offset for frame size
   }
   ```

Note: tldraw's frame shape type is 'frame' with props w, h, name. Colors may not be directly supported in default FrameShapeUtil - use names only.
  </action>
  <verify>
- File exists at `frontend/src/components/Canvas/framePresets.ts`
- Exports createKanbanBoard, createEisenhowerMatrix, createWeeklyColumns, createCustomFrame
- Uses editor.createShape with type: 'frame'
- TypeScript compiles: `cd frontend && npx tsc --noEmit`
  </verify>
  <done>
Frame preset functions create organized layouts with named frames.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add frame preset buttons to toolbar</name>
  <files>
    frontend/src/components/Canvas/CustomToolbar.tsx
  </files>
  <action>
Update CustomToolbar.tsx to add frame preset UI:

1. Import frame preset functions and getViewportCenter from './framePresets'

2. Add state for dropdown/menu visibility (if using dropdown pattern):
   ```typescript
   const [showFrameMenu, setShowFrameMenu] = useState(false)
   ```

3. Add frame preset section to toolbar (choose one approach):

   **Option A - Simple buttons:**
   ```typescript
   // Frame presets section (after tool buttons, before existing sections)
   <div style={{ display: 'flex', gap: 4, borderLeft: '1px solid #e5e7eb', paddingLeft: 8 }}>
     <button
       onClick={() => {
         const { x, y } = getViewportCenter(editor)
         createKanbanBoard(editor, x, y)
       }}
       title="Kanban Board"
       style={buttonStyle}
     >
       Kanban
     </button>
     <button
       onClick={() => {
         const { x, y } = getViewportCenter(editor)
         createEisenhowerMatrix(editor, x, y)
       }}
       title="Eisenhower Matrix"
       style={buttonStyle}
     >
       Matrix
     </button>
     <button
       onClick={() => {
         const { x, y } = getViewportCenter(editor)
         createCustomFrame(editor, x, y, 'Section')
       }}
       title="Add Section"
       style={buttonStyle}
     >
       + Section
     </button>
   </div>
   ```

   **Option B - Dropdown menu (preferred for space):**
   ```typescript
   <div style={{ position: 'relative' }}>
     <button
       onClick={() => setShowFrameMenu(!showFrameMenu)}
       title="Frame Presets"
       style={buttonStyle}
     >
       Frames
     </button>
     {showFrameMenu && (
       <div style={{
         position: 'absolute',
         bottom: '100%',
         left: 0,
         marginBottom: 4,
         background: 'white',
         borderRadius: 8,
         boxShadow: '0 2px 8px rgba(0,0,0,0.15)',
         padding: 4,
         display: 'flex',
         flexDirection: 'column',
         gap: 2,
         minWidth: 150
       }}>
         <button onClick={() => { const { x, y } = getViewportCenter(editor); createKanbanBoard(editor, x, y); setShowFrameMenu(false) }}>
           Kanban Board
         </button>
         <button onClick={() => { const { x, y } = getViewportCenter(editor); createEisenhowerMatrix(editor, x, y); setShowFrameMenu(false) }}>
           Eisenhower Matrix
         </button>
         <button onClick={() => { const { x, y } = getViewportCenter(editor); createWeeklyColumns(editor, x, y); setShowFrameMenu(false) }}>
           Weekly Columns
         </button>
         <button onClick={() => { const { x, y } = getViewportCenter(editor); createCustomFrame(editor, x, y); setShowFrameMenu(false) }}>
           Custom Section
         </button>
       </div>
     )}
   </div>
   ```

4. Style menu items to match existing toolbar aesthetic (same hover states, font, etc.)

5. Close dropdown when clicking outside (useEffect with document click listener)

Use Option B (dropdown) to keep toolbar compact per existing design.
  </action>
  <verify>
- CustomToolbar.tsx imports frame preset functions
- Has "Frames" dropdown or preset buttons visible
- Clicking creates frames at viewport center
- TypeScript compiles: `cd frontend && npx tsc --noEmit`
  </verify>
  <done>
Frame presets accessible from toolbar, creates organized layouts at viewport center.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. TypeScript compilation:
   ```bash
   cd frontend && npx tsc --noEmit
   ```

2. File check:
   - frontend/src/components/Canvas/framePresets.ts exists
   - CustomToolbar.tsx imports from framePresets.ts

3. Function exports:
   - createKanbanBoard, createEisenhowerMatrix, createWeeklyColumns, createCustomFrame all exported
</verification>

<success_criteria>
1. framePresets.ts exports 4 preset functions (Kanban, Eisenhower, Weekly, Custom)
2. Each preset creates properly named frame shapes
3. Kanban creates 3 columns (To Do, In Progress, Done)
4. Eisenhower creates 2x2 grid with proper labels
5. Weekly creates 5 weekday columns
6. Custom creates single named frame
7. Toolbar has frame preset access (dropdown or buttons)
8. Presets appear at viewport center when created
9. All TypeScript compiles without new errors
</success_criteria>

<output>
After completion, create `.planning/phases/05-todo-integration/05-03-SUMMARY.md`
</output>
